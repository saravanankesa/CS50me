{% extends "network/layout.html" %}

{% block body %}
    <h1>{{ user.username }}'s Profile</h1>
    <p>{{ followers }} followers</p>
    <p>{{ following }} following</p>

    <!-- Display posts -->
    {% for post in posts %}
        <div class="post">
            <p>{{ post.content }}</p>
            <small>Posted on {{ post.timestamp }}</small>
        </div>
    {% endfor %}

    {% if user != request.user %}
        <button id="follow-btn" data-username="{{ user.username }}">
            {% if request.user in user.followers.all %}
                Unfollow
            {% else %}
                Follow
            {% endif %}
        </button>
    {% endif %}

    <script>
        document.getElementById("follow-btn").addEventListener("click", function() {
            fetch("{% url 'follow' user.username %}", { method: "POST" })
                .then(response => response.json())
                .then(data => {
                    if (data.status === "success") {
                        location.reload();
                    }
                });
        });
    </script>

{% endblock %}
