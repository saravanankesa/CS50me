{% extends "auctions/layout.html" %}

{% block body %}
  <h2>{{ listing.title }}</h2>
  <p>Description: {{ listing.description }}</p>
  <p>Current Price: {{ listing.current_bid|default:listing.starting_bid }}</p>
  {% if listing.image_url %}
    <img src="{{ listing.image_url }}" alt="Listing Image" style="max-width: 100%;">
  {% endif %}

  {% if user.is_authenticated %}
  {% if listing in user.watchlist.all %}
  <a href="{% url 'remove_from_watchlist' listing.id %}">Remove from Watchlist</a>
  {% else %}
  <a href="{% url 'add_to_watchlist' listing.id %}">Add to Watchlist</a>
  {% endif %}
    {% if user.is_authenticated and listing.active %}
      <form action="{% url 'place_bid' listing.id %}" method="post">
          {% csrf_token %}
          <label for="bid_amount">Your Bid:</label>
          <input type="number" name="bid_amount" min="{{ listing.highest_bid|default:listing.starting_bid }}" step="0.01" required>
          <button type="submit">Place Bid</button>
      </form>
    {% endif %}
    {% if user == listing.creator %}
      <a href="#">Close Auction</a>
    {% endif %}
  {% endif %}
{% endblock %}
